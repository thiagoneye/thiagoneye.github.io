<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Numerical Modeling and Characterization of Oil Reservoirs | Home</title>
<meta name="keywords" content="Reservoir Modeling, Well Characterization, Oil &amp; Gas, Hydraulic Flow Unit, MRST, Petrophysics, Porous Medium">
<meta name="description" content="Computational representation of the physical and geological characteristics of oil wells.">
<meta name="author" content="">
<link rel="canonical" href="https://thiagoneye.github.io/research/research3/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.6128d1ad9cf38fd7062d1e0437df374152778997dcf98c985d476ea066042b6b.css" integrity="sha256-YSjRrZzzj9cGLR4EN983QVJ3iZfc&#43;YyYXUduoGYEK2s=" rel="preload stylesheet" as="style">
<link rel="icon" href="https://thiagoneye.github.io/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://thiagoneye.github.io/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://thiagoneye.github.io/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://thiagoneye.github.io/apple-touch-icon.png">
<link rel="mask-icon" href="https://thiagoneye.github.io/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="https://thiagoneye.github.io/research/research3/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
</noscript>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.10/dist/katex.min.css" integrity="sha384-wcIxkf4k558AjM3Yz3BBFQUbk/zgIYC2R0QpeeYb+TwlBVMrlgLqwRjRtGZiK7ww" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.10/dist/katex.min.js" integrity="sha384-hIoBPJpTUs74ddyc4bFZSM1TVlQDA60VBbJS0oA934VSz82sBx1X7kSx2ATBDIyd" crossorigin="anonymous"></script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.10/dist/contrib/auto-render.min.js" integrity="sha384-43gviWU0YVjaDtb/GhzOouOXtZMP/7XUzwPTstBeZFe/+rCMvRwr4yROQP43s0Xk" crossorigin="anonymous"
  onload="renderMathInElement(document.body);"></script>


<script>
    document.addEventListener("DOMContentLoaded", function() {
        renderMathInElement(document.body, {
          delimiters: [
            {left: '$$', right: '$$', display: true},
            {left: '$', right: '$', display: false},
            {left: "\\begin{equation}", right: "\\end{equation}", display: true},
            {left: "\\begin{equation*}", right: "\\end{equation*}", display: true},
            {left: "\\begin{align}", right: "\\end{align}", display: true},
            {left: "\\begin{align*}", right: "\\end{align*}", display: true},
            {left: "\\begin{gather}", right: "\\end{gather}", display: true},
          ],
          throwOnError : false
        });
    });
</script>
<meta property="og:url" content="https://thiagoneye.github.io/research/research3/">
  <meta property="og:site_name" content="Home">
  <meta property="og:title" content="Numerical Modeling and Characterization of Oil Reservoirs">
  <meta property="og:description" content="Computational representation of the physical and geological characteristics of oil wells.">
  <meta property="og:locale" content="en-us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="research">
    <meta property="article:published_time" content="2019-12-01T00:00:00+00:00">
    <meta property="article:modified_time" content="2019-12-01T00:00:00+00:00">
    <meta property="article:tag" content="Reservoir Modeling">
    <meta property="article:tag" content="Well Characterization">
    <meta property="article:tag" content="Oil & Gas">
    <meta property="article:tag" content="Hydraulic Flow Unit">
    <meta property="article:tag" content="MRST">
    <meta property="article:tag" content="Petrophysics">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Numerical Modeling and Characterization of Oil Reservoirs">
<meta name="twitter:description" content="Computational representation of the physical and geological characteristics of oil wells.">


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Research",
      "item": "https://thiagoneye.github.io/research/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "Numerical Modeling and Characterization of Oil Reservoirs",
      "item": "https://thiagoneye.github.io/research/research3/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Numerical Modeling and Characterization of Oil Reservoirs",
  "name": "Numerical Modeling and Characterization of Oil Reservoirs",
  "description": "Computational representation of the physical and geological characteristics of oil wells.",
  "keywords": [
    "Reservoir Modeling", "Well Characterization", "Oil \u0026 Gas", "Hydraulic Flow Unit", "MRST", "Petrophysics", "Porous Medium"
  ],
  "articleBody": "\nNumerical Modeling of Petroleum Reservoirs Numerical modeling of petroleum reservoirs is an essential tool in the oil and gas industry, allowing us to simulate a reservoir’s behavior over time. The main goal is to predict oil, gas, and water production, optimize development strategies, and manage the field’s lifespan. This simulation involves solving complex equations that describe the flow of fluids (oil, gas, and water) through a porous medium (the reservoir rock) under various pressure and temperature conditions.\nTypes of Numerical Grids The numerical grid is the discretization of the reservoir volume into smaller cells, where the flow equations are solved. The choice of grid type directly impacts the simulation’s accuracy and computational efficiency. Common types include:\nCartesian: These are the simplest, formed by rectangular or cubic cells. They’re easy to build and suitable for reservoirs with simple geometries and horizontal layers. However, they don’t represent complex geometries or faults well. Unstructured Grids: These offer great flexibility to adapt to complex geometries, such as faults, channels, and lenses, using cells of various shapes (triangles, tetrahedrons). They are more complex to build and computationally more demanding. Corner-Point Grid: This is a structured, yet flexible, grid type widely used in reservoir modeling. Each cell is defined by eight corner points (vertices), allowing the cell faces to be neither necessarily planar nor perpendicular. The main advantage of the Corner-Point grid is its ability to represent geological faults and dipping layers with greater accuracy than Cartesian grids, while maintaining an organized structure that facilitates cell indexing. This allows the grid to deform to follow the stratigraphy and discontinuities of the reservoir. Although more complex to build than a Cartesian grid, it’s significantly less complex than an unstructured grid, making it a good compromise between geometric precision and computational efficiency for most reservoir cases.\nReservoir Characterization Reservoir characterization is the process of defining the reservoir’s geological and petrophysical properties. This involves integrating data from various sources, such as:\nGeology: Analysis of cores, well logs, and seismic data to understand the structure, stratigraphy, sedimentology, and identification of faults and fractures. Petrophysics: Measurement and interpretation of rock properties (porosity, permeability, fluid saturation) obtained from well logs and laboratory analyses. Production Data: Historical oil, gas, and water production from wells, reservoir pressures, and well tests, which provide dynamic information about the reservoir’s behavior. The accuracy of the characterization is fundamental, as it defines the input parameters for the numerical model. A poorly characterized model will produce unrealistic results.\nPetrophysics Petrophysics is the study of the physical properties of rocks that influence fluid flow in porous media. The main petrophysical properties for numerical modeling include:\nPorosity ($\\phi$): This is the fraction of the total rock volume occupied by pores (void spaces) where fluids can be stored. It’s a measure of the reservoir’s storage capacity. Permeability ($k$): This is the ability of the rock to allow fluids to flow through its interconnected pores. It’s a measure of the reservoir’s hydraulic conductivity. Fluid Saturation ($S_o$, $S_g$, $S_w$): Represents the fraction of the pore volume occupied by each fluid type (oil, gas, water). The sum of saturations must equal 1. Compressibility ($c$): Measures the change in rock or fluid volume in response to a pressure change. Hydraulic Flow Units A hydraulic flow unit is a continuous and mappable volume of reservoir rock that shares consistent geological and petrophysical characteristics, sufficiently so to control fluid flow in a similar manner. This means that within a flow unit, porosity and permeability (and their relationships with fluid saturation) are relatively homogeneous, simplifying flow modeling. Identifying and mapping these units is crucial for simplifying the reservoir model and ensuring that petrophysical properties are correctly assigned within the numerical grid.\nFlow in Porous Media Flow in porous media is the study of fluid movement (oil, gas, water) through the network of pores and pore throats of a reservoir rock. This process is governed by physical laws, with Darcy’s Law being the basis for describing flow in laminar regimes:\n$$ q = - \\dfrac{kA}{\\mu} \\dfrac{dP}{dx}$$\nWhere:\n$q$ is the volumetric flow rate $k$ is the permeability of the porous medium $A$ is the cross-sectional area $\\mu$ is the fluid viscosity $\\frac{dP}{dx}$ is the pressure gradient Numerical modeling extends Darcy’s Law to multiple phases (oil, gas, water) and to heterogeneous and anisotropic media, also considering the effects of gravity and capillarity.\nBlack-Oil Model The Black-Oil model is one of the most common and widely used models for reservoir simulation. It’s a simplified compositional model that treats oil and gas as binary mixtures or pseudocomponents. The central premise is that gas can dissolve in oil and oil can evaporate into gas, but there is no mass exchange between the individual components of each phase (e.g., light components of oil don’t separate into a pure gas phase, and heavy components of gas don’t liquefy into a pure oil phase).\nIn the Black-Oil model, fluids are typically described by:\nFormation Volume Factor (FVF): Relates the volume of a phase (oil or gas) at the surface to its volume in the reservoir. Gas-Oil Ratio (GOR): The amount of gas that separates from the oil under surface conditions. Viscosity: The resistance to flow for each phase. Bubble Point Pressure / Dew Point Pressure: The pressures at which gas begins to separate from oil or oil begins to condense from gas, respectively. This model is computationally efficient and suitable for most light oil and dry gas reservoirs. However, for reservoirs with more complex fluids (such as heavy oil, gas condensates, or high-pressure gas injection), more sophisticated compositional models may be necessary.\nRelated Material The MATLAB Reservoir Simulation Toolbox (MRST) is a free open-source software for reservoir modelling and simulation, developed primarily by the Applied Computational Science group in the Department of Mathematics and Cybernetics at SINTEF Digital.\n",
  "wordCount" : "961",
  "inLanguage": "en",
  "datePublished": "2019-12-01T00:00:00Z",
  "dateModified": "2019-12-01T00:00:00Z",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://thiagoneye.github.io/research/research3/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Home",
    "logo": {
      "@type": "ImageObject",
      "url": "https://thiagoneye.github.io/favicon.ico"
    }
  }
}
</script>
</head>

<body class=" dark" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://thiagoneye.github.io/" accesskey="h" title="Home (Alt + H)">Home</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)" aria-label="Toggle theme">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://thiagoneye.github.io/about_me/" title="About Me">
                    <span>About Me</span>
                </a>
            </li>
            <li>
                <a href="https://thiagoneye.github.io/experience/" title="Experience">
                    <span>Experience</span>
                </a>
            </li>
            <li>
                <a href="https://thiagoneye.github.io/research/" title="Research">
                    <span>Research</span>
                </a>
            </li>
            <li>
                <a href="https://thiagoneye.github.io/publications/" title="Publications">
                    <span>Publications</span>
                </a>
            </li>
            <li>
                <a href="https://thiagoneye.github.io/others/" title="Others">
                    <span>Others</span>
                </a>
            </li>
            <li>
                <a href="https://thiagoneye.github.io/tags/" title="Tags">
                    <span>Tags</span>
                </a>
            </li>
            <li>
                <a href="https://thiagoneye.github.io/contact/" title="Contact">
                    <span>Contact</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    
    <h1 class="post-title entry-hint-parent">
      Numerical Modeling and Characterization of Oil Reservoirs
    </h1>
    <div class="post-meta"><span title='2019-12-01 00:00:00 +0000 UTC'>2019</span>

</div>
  </header> <div class="toc">
    <details >
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">Table of Contents</span>
        </summary>

        <div class="inner"><ul>
                <li>
                    <a href="#numerical-modeling-of-petroleum-reservoirs" aria-label="Numerical Modeling of Petroleum Reservoirs">Numerical Modeling of Petroleum Reservoirs</a></li>
                <li>
                    <a href="#types-of-numerical-grids" aria-label="Types of Numerical Grids">Types of Numerical Grids</a></li>
                <li>
                    <a href="#reservoir-characterization" aria-label="Reservoir Characterization">Reservoir Characterization</a><ul>
                        
                <li>
                    <a href="#petrophysics" aria-label="Petrophysics">Petrophysics</a></li>
                <li>
                    <a href="#hydraulic-flow-units" aria-label="Hydraulic Flow Units">Hydraulic Flow Units</a></li></ul>
                </li>
                <li>
                    <a href="#flow-in-porous-media" aria-label="Flow in Porous Media">Flow in Porous Media</a><ul>
                        
                <li>
                    <a href="#black-oil-model" aria-label="Black-Oil Model">Black-Oil Model</a></li></ul>
                </li>
                <li>
                    <a href="#related-material" aria-label="Related Material">Related Material</a>
                </li>
            </ul>
        </div>
    </details>
</div>

  <div class="post-content"><p><img loading="lazy" src="/research/research3/unisim1d_overview.png"></p>
<hr>
<h2 id="numerical-modeling-of-petroleum-reservoirs">Numerical Modeling of Petroleum Reservoirs</h2>
<p>Numerical modeling of petroleum reservoirs is an essential tool in the oil and gas industry, allowing us to simulate a reservoir&rsquo;s behavior over time. The main goal is to predict oil, gas, and water production, optimize development strategies, and manage the field&rsquo;s lifespan. This simulation involves solving complex equations that describe the flow of fluids (oil, gas, and water) through a porous medium (the reservoir rock) under various pressure and temperature conditions.</p>
<h2 id="types-of-numerical-grids">Types of Numerical Grids</h2>
<p>The numerical grid is the discretization of the reservoir volume into smaller cells, where the flow equations are solved. The choice of grid type directly impacts the simulation&rsquo;s accuracy and computational efficiency. Common types include:</p>
<ul>
<li>Cartesian: These are the simplest, formed by rectangular or cubic cells. They&rsquo;re easy to build and suitable for reservoirs with simple geometries and horizontal layers. However, they don&rsquo;t represent complex geometries or faults well.</li>
<li>Unstructured Grids: These offer great flexibility to adapt to complex geometries, such as faults, channels, and lenses, using cells of various shapes (triangles, tetrahedrons). They are more complex to build and computationally more demanding.</li>
<li>Corner-Point Grid: This is a structured, yet flexible, grid type widely used in reservoir modeling. Each cell is defined by eight corner points (vertices), allowing the cell faces to be neither necessarily planar nor perpendicular.</li>
</ul>
<p>The main advantage of the Corner-Point grid is its ability to represent geological faults and dipping layers with greater accuracy than Cartesian grids, while maintaining an organized structure that facilitates cell indexing. This allows the grid to deform to follow the stratigraphy and discontinuities of the reservoir. Although more complex to build than a Cartesian grid, it&rsquo;s significantly less complex than an unstructured grid, making it a good compromise between geometric precision and computational efficiency for most reservoir cases.</p>
<hr>
<h2 id="reservoir-characterization">Reservoir Characterization</h2>
<p>Reservoir characterization is the process of defining the reservoir&rsquo;s geological and petrophysical properties. This involves integrating data from various sources, such as:</p>
<ul>
<li>Geology: Analysis of cores, well logs, and seismic data to understand the structure, stratigraphy, sedimentology, and identification of faults and fractures.</li>
<li>Petrophysics: Measurement and interpretation of rock properties (porosity, permeability, fluid saturation) obtained from well logs and laboratory analyses.</li>
<li>Production Data: Historical oil, gas, and water production from wells, reservoir pressures, and well tests, which provide dynamic information about the reservoir&rsquo;s behavior.</li>
</ul>
<p>The accuracy of the characterization is fundamental, as it defines the input parameters for the numerical model. A poorly characterized model will produce unrealistic results.</p>
<h3 id="petrophysics">Petrophysics</h3>
<p>Petrophysics is the study of the physical properties of rocks that influence fluid flow in porous media. The main petrophysical properties for numerical modeling include:</p>
<ul>
<li>Porosity ($\phi$): This is the fraction of the total rock volume occupied by pores (void spaces) where fluids can be stored. It&rsquo;s a measure of the reservoir&rsquo;s storage capacity.</li>
<li>Permeability ($k$): This is the ability of the rock to allow fluids to flow through its interconnected pores. It&rsquo;s a measure of the reservoir&rsquo;s hydraulic conductivity.</li>
<li>Fluid Saturation ($S_o$, $S_g$, $S_w$): Represents the fraction of the pore volume occupied by each fluid type (oil, gas, water). The sum of saturations must equal 1.</li>
<li>Compressibility ($c$): Measures the change in rock or fluid volume in response to a pressure change.</li>
</ul>
<h3 id="hydraulic-flow-units">Hydraulic Flow Units</h3>
<p>A hydraulic flow unit is a continuous and mappable volume of reservoir rock that shares consistent geological and petrophysical characteristics, sufficiently so to control fluid flow in a similar manner. This means that within a flow unit, porosity and permeability (and their relationships with fluid saturation) are relatively homogeneous, simplifying flow modeling. Identifying and mapping these units is crucial for simplifying the reservoir model and ensuring that petrophysical properties are correctly assigned within the numerical grid.</p>
<hr>
<h2 id="flow-in-porous-media">Flow in Porous Media</h2>
<p>Flow in porous media is the study of fluid movement (oil, gas, water) through the network of pores and pore throats of a reservoir rock. This process is governed by physical laws, with Darcy&rsquo;s Law being the basis for describing flow in laminar regimes:</p>
<p>$$ q = - \dfrac{kA}{\mu} \dfrac{dP}{dx}$$</p>
<p>Where:</p>
<ul>
<li>$q$ is the volumetric flow rate</li>
<li>$k$ is the permeability of the porous medium</li>
<li>$A$ is the cross-sectional area</li>
<li>$\mu$ is the fluid viscosity</li>
<li>$\frac{dP}{dx}$ is the pressure gradient</li>
</ul>
<p>Numerical modeling extends Darcy&rsquo;s Law to multiple phases (oil, gas, water) and to heterogeneous and anisotropic media, also considering the effects of gravity and capillarity.</p>
<h3 id="black-oil-model">Black-Oil Model</h3>
<p>The Black-Oil model is one of the most common and widely used models for reservoir simulation. It&rsquo;s a simplified compositional model that treats oil and gas as binary mixtures or pseudocomponents. The central premise is that gas can dissolve in oil and oil can evaporate into gas, but there is no mass exchange between the individual components of each phase (e.g., light components of oil don&rsquo;t separate into a pure gas phase, and heavy components of gas don&rsquo;t liquefy into a pure oil phase).</p>
<p>In the Black-Oil model, fluids are typically described by:</p>
<ul>
<li>Formation Volume Factor (FVF): Relates the volume of a phase (oil or gas) at the surface to its volume in the reservoir.</li>
<li>Gas-Oil Ratio (GOR): The amount of gas that separates from the oil under surface conditions.</li>
<li>Viscosity: The resistance to flow for each phase.</li>
<li>Bubble Point Pressure / Dew Point Pressure: The pressures at which gas begins to separate from oil or oil begins to condense from gas, respectively.</li>
</ul>
<p>This model is computationally efficient and suitable for most light oil and dry gas reservoirs. However, for reservoirs with more complex fluids (such as heavy oil, gas condensates, or high-pressure gas injection), more sophisticated compositional models may be necessary.</p>
<hr>
<h2 id="related-material">Related Material</h2>
<p>The <a href="https://www.sintef.no/projectweb/mrst/">MATLAB Reservoir Simulation Toolbox (MRST)</a> is a free open-source software for reservoir modelling and simulation, developed primarily by the Applied Computational Science group in the Department of Mathematics and Cybernetics at SINTEF Digital.</p>

  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://thiagoneye.github.io/tags/reservoir-modeling/">Reservoir Modeling</a></li>
      <li><a href="https://thiagoneye.github.io/tags/well-characterization/">Well Characterization</a></li>
      <li><a href="https://thiagoneye.github.io/tags/oil--gas/">Oil &amp; Gas</a></li>
      <li><a href="https://thiagoneye.github.io/tags/hydraulic-flow-unit/">Hydraulic Flow Unit</a></li>
      <li><a href="https://thiagoneye.github.io/tags/mrst/">MRST</a></li>
      <li><a href="https://thiagoneye.github.io/tags/petrophysics/">Petrophysics</a></li>
      <li><a href="https://thiagoneye.github.io/tags/porous-medium/">Porous Medium</a></li>
    </ul>
<nav class="paginav">
  <a class="prev" href="https://thiagoneye.github.io/research/research4/">
    <span class="title">« Prev</span>
    <br>
    <span>Application of Optimization Techniques in Industrial Environments</span>
  </a>
  <a class="next" href="https://thiagoneye.github.io/research/research2/">
    <span class="title">Next »</span>
    <br>
    <span>Flight Dynamics Analysis and Control Surface Design</span>
  </a>
</nav>

  </footer>
</article>
    </main>
    
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'copy';

        function copyingDone() {
            copybutton.innerHTML = 'copied!';
            setTimeout(() => {
                copybutton.innerHTML = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
